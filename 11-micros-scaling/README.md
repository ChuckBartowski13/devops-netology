# Домашнее задание к занятию «Микросервисы: масштабирование»

Вы работаете в крупной компании, которая строит систему на основе микросервисной архитектуры.
Вам как DevOps-специалисту необходимо выдвинуть предложение по организации инфраструктуры для разработки и эксплуатации.

## Задача 1: Кластеризация

Предложите решение для обеспечения развёртывания, запуска и управления приложениями.
Решение может состоять из одного или нескольких программных продуктов и должно описывать способы и принципы их взаимодействия.

Решение должно соответствовать следующим требованиям:
- поддержка контейнеров;
- обеспечивать обнаружение сервисов и маршрутизацию запросов;
- обеспечивать возможность горизонтального масштабирования;
- обеспечивать возможность автоматического масштабирования;
- обеспечивать явное разделение ресурсов, доступных извне и внутри системы;
- обеспечивать возможность конфигурировать приложения с помощью переменных среды, в том числе с возможностью безопасного хранения чувствительных данных таких как пароли, ключи доступа, ключи шифрования и т. п.

Обоснуйте свой выбор.

## Ответ

По моему мнению наиболее подходящее решение - развернуть Kubernetes кластер:
1. Kubernetes поддерживает разные системы контейнеризации.
2. Кластера Kubernetes автоматически настраивают внутреннюю DNS, чтобы обеспечить легкий механизм для обнаружения сервисов. Встроенное обнаружение сервисов в кластерах Kubernetes облегчает приложениям поиск и связь друг с другом: каждому сервису, созданному с помощью объекта `service` присваивается доменное имя совпадающее с именем самого сервиса. Маршрутизация происходит через `kube-proxy` и `virtual ip`.
3. При разворачивании нового сервиса мы самостоятельно можем указать сколько реплик должно у него быть для отказоустойчивости или распределения нагрузки. Также сам кластер можно без проблем горизонтально масштабировать, добавляя в него новые ноды и распределяя на них имеющиеся нагрузки. Это очень важно ввиду ограничения кол-во активных подов на ноду в размере 110.
4. Horizontal Pod Autoscaling масштабирует количество реплик pod'ов. В качестве триггеров для изменения количества реплик можно использовать нагрузку на процессор, память. В зависимости от настроек Kubernetes сам будет поддерживать необходимое кол-во подов для нормального функционирования сервиса.
5. Способ разделить кластер на индивидуальные зоны - Namespaces. `NetworkPolicy` и `GlobalNetworkPolicy` дает разграничение сетевого доступа внутри кластера. `ingress-controller` - обеспечивает маршрутизацию трафика наружу кластера.
6. В Kubernetes есть объект - `secret` для хранения чувствительных данных. 'Env` для установки переменных сред в контейнеры. Также для хранения секретов можно развернуть в дополнение HashiCorp Vault.
